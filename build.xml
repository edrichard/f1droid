<?xml version="1.0" encoding="UTF-8"?>
<project name="f1droid" default="apk">

    <property name="path.compile" value="./bin" />
    <property name="path.source" value="./src" />
    <property name="path.documentation" value="./doc" />
    <property name="path.report" value="./rep" />
    <property name="path.libs" value="./libs" />
    
    <!-- CLEAN -->
    <target name="clean" description="Remove intermediate files">
        <delete dir="${path.compile}" />
        <delete dir="${path.documentation}" />
        <delete dir="${path.report}" />
    </target>
    
    <!-- PMD -->
    <path id="pmd.classpath">
        <pathelement location="${build}" />
        <fileset dir="libs/pmd/lib/">
            <include name="*.jar" />
        </fileset>
    </path>

    <taskdef name="pmd" classname="net.sourceforge.pmd.ant.PMDTask" classpathref="pmd.classpath" />
    <taskdef resource="checkstyletask.properties" classpath="libs/checkstyle/checkstyle-5.7-all.jar" />
    
    <target name="pmd">
        <mkdir dir="${path.report}" />
        <pmd rulesetfiles="rulesets/java/design.xml">
            <formatter type="xml" toFile="${path.report}/pmd_report.xml" />
            <fileset dir="${path.source}">
                <include name="**/*.java" />
            </fileset>
        </pmd>
    </target>

    <!-- CHECKSTYLE -->
    <target name="checkstyle">
        <mkdir dir="${path.report}" />
        <taskdef resource="checkstyletask.properties" classpath="${path.libs}/checkstyle-5.7-all.jar" />
        <checkstyle config="${path.libs}/sun_checks.xml" failOnViolation="false">
            <fileset dir="${path.source}" includes="**/*.java" />
            <formatter type="xml" toFile="${path.report}/checkstyle_errors.xml" />
        </checkstyle>
    </target>

    <target name="all" depends="clean, junit, pmd, checkstyle, jar, doc" />

</project>
